# CSC8502 课程作业 - 项目进度与下一步计划

**更新日期**：当前阶段
**项目主题**：冬季森林 ↔ 夏季森林场景转换
**截止日期**：11月14日（演示）

---

## 📊 当前完成情况

### ✅ 已完成功能（第1-2阶段）

#### 阶段1：基础系统搭建
- ✅ **窗口管理系统**（Window 类）- GLFW窗口创建和事件处理
- ✅ **着色器系统**（Shader 类）- GLSL加载、编译、uniform设置
- ✅ **相机系统**（Camera 类）- 第一人称相机，WASD移动，鼠标视角控制
- ✅ **纹理加载系统**（Texture 类）- STB_image，支持PNG/JPG，Mipmap生成
- ✅ **输入处理系统** - 键盘、鼠标、滚轮完整支持

#### 阶段2：核心渲染功能
- ✅ **地形生成系统**（Terrain 类）
  - 从高度图生成3D地形网格
  - 顶点位置、法向量、纹理坐标计算
  - VAO/VBO/EBO配置
  - 平滑法向量计算
  - 双线性插值高度查询

- ✅ **基础光照系统**（Phong模型基础）
  - 环境光（Ambient）
  - 漫反射光（Diffuse）
  - 地形着色器集成

#### 技术储备
- ✅ OpenGL 3.3 Core Profile
- ✅ 深度测试配置
- ✅ 纹理过滤和Mipmap
- ✅ 详细的中文代码注释（超1000行）

---

## 📈 当前状态总结

### 🎯 可运行的功能
✅ **地形渲染系统** - 完整可用
- 从高度图生成起伏地形
- 应用草地纹理
- 光照计算（明暗对比）
- 自由飞行相机

### ⚠️ 已知小问题（不影响整体）
- 地形有轻微断层现象（已禁用背面剔除，暂不影响）
- 光照对比度可能需要微调（已基本解决）

### 💪 当前优势
- ✅ 核心渲染管线已建立
- ✅ 地形系统功能完整
- ✅ 代码结构清晰，易于扩展
- ✅ 所有代码都有详细注释

---

## 🎯 课程作业要求对照

### 核心功能（必须实现）

| 要求 | 状态 | 说明 |
|------|------|------|
| 1. 地形渲染，纹理映射 | ✅ 完成 | 高度图地形 + 草地纹理 |
| 2. 光照系统（环境+漫反射+镜面） | 🟡 部分完成 | 环境光+漫反射 ✅，镜面反射待添加 |
| 3. 环境映射演示 | ❌ 未开始 | 需要先完成天空盒 |
| 4. 自动相机路径 | ❌ 未开始 | 需要实现相机动画系统 |
| 5. 场景图管理 | ❌ 未开始 | 需要SceneNode类 |
| 6. 组合式场景元素 | ❌ 未开始 | 需要加载3D模型（树、石头） |

### 高级功能（选择实现）

| 功能 | 优先级 | 状态 | 说明 |
|------|--------|------|------|
| 后期处理效果 | ⭐⭐⭐ 高 | ❌ 未开始 | 时间转换效果的基础 |
| 天空盒 | ⭐⭐⭐ 高 | ❌ 未开始 | 场景背景，环境映射需要 |
| 阴影映射 | ⭐⭐ 中 | ❌ 未开始 | 增强立体感 |
| 3D模型加载 | ⭐⭐⭐ 高 | ❌ 未开始 | 树木、岩石 |
| 动画效果 | ⭐⭐ 中 | ❌ 未开始 | 草地摇摆、树叶飘落 |
| 时间转换 | ⭐⭐⭐ 最高 | ❌ 未开始 | **核心功能** |

---

## 📅 下一步实现计划（按优先级）

### 🎯 近期目标（1-2周）

接下来我们要完成以下任务，按照**从易到难、从基础到高级**的顺序：

---

### 📝 第1优先：天空盒系统（1-2天）

**为什么现在做？**
- ✅ 技术难度：中等（比模型加载简单）
- ✅ 视觉效果：立竿见影（背景天空）
- ✅ 是环境映射的前置条件
- ✅ 增强场景沉浸感

**实现内容：**
1. **Skybox 类**
   - 立方体贴图（Cubemap）加载
   - 6张纹理：上、下、左、右、前、后
   - 特殊渲染技巧（去除平移、深度测试）

2. **天空盒着色器**
   - `skyboxVertex.glsl` - 只保留旋转变换
   - `skyboxFragment.glsl` - 采样立方体贴图

3. **渲染流程**
   - 最后渲染天空盒（深度值=1.0）
   - 禁用深度写入

**需要的资源：**
- 夏季天空盒（6张图）
- 冬季天空盒（6张图）
- 推荐网站：[Poly Haven](https://polyhaven.com/hdris)

**预计时间：** 1-2天

---

### 📝 第2优先：完善光照系统（0.5天）

**为什么需要？**
- 课程要求：必须有完整的Phong光照
- 当前只有环境光+漫反射
- 需要添加镜面反射（Specular）

**实现内容：**
1. 在 `terrainFragment.glsl` 中添加镜面反射计算
2. 调整材质参数（shininess）
3. 测试光照效果

**预计时间：** 半天

---

### 📝 第3优先：OBJ模型加载系统（2-3天）

**为什么重要？**
- 课程要求：需要组合式场景元素
- 添加树木、岩石丰富场景
- 为冬夏两季准备不同模型

**实现内容：**

#### 方案A：手动实现（学习价值高）
1. **Mesh 类** - 存储网格数据
2. **OBJLoader 类** - 解析.obj文件
   - 读取顶点 (v)
   - 读取纹理坐标 (vt)
   - 读取法向量 (vn)
   - 解析面 (f)

#### 方案B：使用库（快速实现）
- 使用 `tinyobjloader` 库
- 只需要写加载代码
- 更稳定，支持复杂模型

**推荐：方案B**（时间紧张的情况下）

**需要的资源：**
- 夏季树木模型（2-3个）
- 冬季树木模型（光秃的树）
- 岩石模型（1-2个）
- 推荐网站：[Sketchfab](https://sketchfab.com/)（筛选CC许可）

**预计时间：** 2-3天

---

### 📝 第4优先：场景图系统（1-2天）

**为什么需要？**
- 课程要求
- 管理地形、多个树木、岩石
- 支持层级变换（如树上的树叶）

**实现内容：**
1. **SceneNode 类**
   - 父子关系管理
   - 局部变换 → 世界变换
   - 递归渲染

2. **场景组织**
   ```
   根节点
   ├── 地形
   ├── 天空盒
   ├── 树木组
   │   ├── 夏季树1
   │   ├── 夏季树2
   │   └── 夏季树3
   └── 岩石组
       ├── 岩石1
       └── 岩石2
   ```

**预计时间：** 1-2天

---

### 📝 第5优先：自动相机路径（1天）

**为什么需要？**
- 课程要求
- 演示视频必备
- 展示场景的最佳方式

**实现内容：**
1. 定义3-5个关键点
2. 线性插值或平滑曲线
3. 按键切换自动/手动模式

**实现方式：**
```cpp
// 在Camera类中添加
std::vector<glm::vec3> waypoints;
void AutoMove(float deltaTime);
bool autoMode = false;
```

**预计时间：** 1天

---

### 📝 第6优先：环境映射（1天）

**为什么需要？**
- 课程要求
- 演示反射效果
- 可以做水面或冰面

**实现内容：**
1. 在地形上添加"水面区域"
2. 使用天空盒作为环境贴图
3. 计算反射向量
4. 混合反射和基础纹理

**预计时间：** 1天

---

### 📝 第7优先：时间转换效果（3-4天）⭐ 核心

**这是课程作业的核心功能！**

**实现内容：**

#### 阶段1：后期处理框架（1天）
1. **FrameBuffer 类**
   - 创建FBO（帧缓冲对象）
   - 渲染到纹理
   - 屏幕四边形

2. **测试效果**
   - 灰度、反色、模糊

#### 阶段2：双场景管理（1天）
1. 夏季场景资源
   - 草地纹理
   - 绿树模型
   - 夏季天空盒

2. 冬季场景资源
   - 雪地纹理
   - 光秃树木
   - 冬季天空盒

#### 阶段3：转换着色器（1-2天）
1. **创意效果选择**
   - 涟漪溶解
   - 像素化扩散
   - 波纹过渡
   - 时间扭曲

2. **实现转换**
   - 渲染两个场景到不同纹理
   - 用转换着色器混合
   - 时间参数控制进度

**预计时间：** 3-4天

---

## 📊 时间规划（距离11月14日）

假设现在是10月底，我们有约2周时间：

### Week 1（第1周）
**目标：完成基础场景元素**

| 天数 | 任务 | 预计工作量 |
|------|------|------------|
| Day 1-2 | 天空盒系统 | 1-2天 |
| Day 3 | 完善光照（镜面反射） | 0.5天 |
| Day 3-5 | OBJ模型加载 + 放置树木岩石 | 2-3天 |
| Day 6 | 场景图系统 | 1天 |
| Day 7 | 缓冲 + 调试 | 1天 |

**Week 1 结束时应该有：**
- ✅ 有天空的地形场景
- ✅ 场景中有树木和岩石
- ✅ 完整的Phong光照
- ✅ 场景图管理所有物体

### Week 2（第2周）
**目标：高级功能和时间转换**

| 天数 | 任务 | 预计工作量 |
|------|------|------------|
| Day 8 | 自动相机路径 | 1天 |
| Day 9 | 环境映射（水面反射） | 1天 |
| Day 10-13 | 时间转换效果系统 | 3-4天 |
| Day 14 | 测试、录视频、文档 | 1天 |

**Week 2 结束时应该有：**
- ✅ 完整的冬夏场景切换
- ✅ 自动相机演示
- ✅ 所有核心功能
- ✅ 演示视频 + 文档

---

## 🎯 最小可完成版本（MVP）

如果时间真的不够，可以按这个优先级砍功能：

### 必须保留（不能砍）
- ✅ 地形系统（已完成）
- ✅ 纹理贴图（已完成）
- ✅ 基础光照（已完成）
- ⭐ 天空盒
- ⭐ 至少3-5个树木模型
- ⭐ 场景图
- ⭐ 自动相机
- ⭐ 时间转换（简化版也行）

### 可以简化
- 环境映射 → 可以不做水面反射
- 模型种类 → 只用树木，不用岩石
- 转换效果 → 用简单的渐隐渐显

### 可以砍掉
- 阴影映射（技术难度高）
- 动画效果（非必需）
- 复杂的后期处理

---

## 💡 实施建议

### 开发策略
1. **逐个功能完成** - 不要同时开几个功能
2. **频繁测试** - 每完成一个功能就运行测试
3. **保持代码整洁** - 保持详细注释
4. **早做时间转换** - 这是核心，别留到最后

### 资源准备
- **现在就开始收集资源**
  - 天空盒纹理（夏季+冬季）
  - 树木模型（夏季+冬季）
  - 岩石模型
  - 草地、雪地纹理

- **推荐资源网站**
  - 纹理：[Poly Haven](https://polyhaven.com/)
  - 模型：[Sketchfab](https://sketchfab.com/)（CC License）
  - 天空盒：[LearnOpenGL](https://learnopengl.com/Advanced-OpenGL/Cubemaps)

### 风险控制
- **每周五检查进度** - 看是否需要调整计划
- **保留缓冲时间** - 每周预留1天处理意外
- **提前录视频** - 不要等到最后一天

---

## 🚀 立即行动：下一步做什么？

### 现在开始：天空盒系统

**立即行动清单：**
1. ✅ 下载天空盒纹理（夏季 + 冬季各6张）
2. ✅ 创建 `Skybox.h` 和 `Skybox.cpp`
3. ✅ 编写天空盒着色器
4. ✅ 在 `main.cpp` 中集成
5. ✅ 测试渲染效果

**我可以帮你：**
- 写Skybox类的完整代码（含详细注释）
- 写天空盒着色器
- 指导如何下载和准备天空盒纹理
- 集成到现有场景中

---

## 📝 检查清单

使用这个清单追踪你的进度：

### 核心功能
- [x] 地形系统
- [x] 纹理系统
- [x] 基础光照
- [ ] 天空盒
- [ ] 完整光照（镜面反射）
- [ ] 模型加载
- [ ] 场景图
- [ ] 自动相机
- [ ] 环境映射
- [ ] 时间转换

### 文档和演示
- [ ] 4张以上截图
- [ ] 控制说明文档
- [ ] YouTube演示视频（3-5分钟）
- [ ] 代码打包（去除.vs, .git, x64）

---

## 💬 下一步行动

**你现在可以选择：**

1. **立即开始天空盒** - 我会帮你写完整代码
2. **先完善光照** - 添加镜面反射（快速）
3. **先准备资源** - 下载天空盒、模型等
4. **调整计划** - 如果你有其他想法

**告诉我你想先做什么，我会立即开始帮你实现！** 😊

---

**记住：我们已经完成了最困难的地形系统，后面的功能会越来越快！加油！** 🎉
